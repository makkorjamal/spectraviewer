<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" 
    integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <link href="/css/sidebar.css" rel="stylesheet">
  </head>
  <body>
    <div class="sidebar">
    <div id="header">
       <a href='https://www.uni-bremen.de'>
        <img class='uni-logo' src='https://onlinetools.zfn.uni-bremen.de/server/images/logo_ub.png'>
      </a>
    </div>
    <div class="container">
      <div class="header">
        <h2 class="text-center text-muted">Jungfraujoch Spectra Viewer</h1>
      </div>
       <div>
        {% block spec_select %}{% endblock %}
       </div>
       </div>
      </div>
      <div class="mainbar">
      <div id = "loader" class="loader"></div> 
      <div id="processed_results">
      </div>

      <div>
        <canvas id="calChart" width="200" height="80"></canvas>
      </div>
      <div>
        <canvas id="digChart" width="200" height="80"></canvas>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js" 
      integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" 
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" 
      integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" 
      crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/spplotter.js"></script>

    <script type="text/javascript">
      $(document).ready(function() {
        let mLoader = document.getElementById("loader");
        $('#years').change(function(){

          $.getJSON('/_update_dropdown', {
            selected_year: $('#years').val()

          }).done(function(data) {
                $('#spectra').html(data.shtml);
           })
        });
        $('#process_input').bind('click', function() {
            mLoader.style.visibility="visible";            
            $.getJSON('/_draw_table', {
                selected_year: $('#years').val(),
                selected_spectrum: $('#spectra').val(),
            }).done((data) => {
              $('#stable').html(data.shtml)
            });
            $.getJSON('/_plot_data', {
                selected_year: $('#years').val(),
                selected_spectrum: $('#spectra').val(),
            }
            ).done(function(spectrum) {
                mLoader.style.visibility="hidden";
                chartPlotter(spectrum.calibrated_in,
                spectrum.wavenumber_lbl,
                spectrum.digitized_in,
                spectrum.pixel_lbl,
                spectrum.im_filename,
                spectrum.imheight);
            });         
          return false;

        });
      });
    </script>
  </body>
</html>